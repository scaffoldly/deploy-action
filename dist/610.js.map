{"version":3,"file":"610.js","mappings":"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","sources":["webpack://@scaffoldly/deploy-action/./node_modules/@aws-sdk/credential-provider-http/dist-es/fromHttp/retry-wrapper.js","webpack://@scaffoldly/deploy-action/./node_modules/@aws-sdk/credential-provider-http/dist-es/fromHttp/fromHttp.js","webpack://@scaffoldly/deploy-action/./node_modules/@aws-sdk/credential-provider-http/dist-es/fromHttp/checkUrl.js","webpack://@scaffoldly/deploy-action/./node_modules/@aws-sdk/credential-provider-http/dist-es/fromHttp/requestHelpers.js"],"sourcesContent":["export const retryWrapper = (toRetry, maxRetries, delayMs) => {\n    return async () => {\n        for (let i = 0; i < maxRetries; ++i) {\n            try {\n                return await toRetry();\n            }\n            catch (e) {\n                await new Promise((resolve) => setTimeout(resolve, delayMs));\n            }\n        }\n        return await toRetry();\n    };\n};\n","import { NodeHttpHandler } from \"@smithy/node-http-handler\";\nimport { CredentialsProviderError } from \"@smithy/property-provider\";\nimport fs from \"fs/promises\";\nimport { checkUrl } from \"./checkUrl\";\nimport { createGetRequest, getCredentials } from \"./requestHelpers\";\nimport { retryWrapper } from \"./retry-wrapper\";\nconst AWS_CONTAINER_CREDENTIALS_RELATIVE_URI = \"AWS_CONTAINER_CREDENTIALS_RELATIVE_URI\";\nconst DEFAULT_LINK_LOCAL_HOST = \"http://169.254.170.2\";\nconst AWS_CONTAINER_CREDENTIALS_FULL_URI = \"AWS_CONTAINER_CREDENTIALS_FULL_URI\";\nconst AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE = \"AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE\";\nconst AWS_CONTAINER_AUTHORIZATION_TOKEN = \"AWS_CONTAINER_AUTHORIZATION_TOKEN\";\nexport const fromHttp = (options) => {\n    options.logger?.debug(\"@aws-sdk/credential-provider-http\", \"fromHttp\");\n    let host;\n    const relative = options.awsContainerCredentialsRelativeUri ?? process.env[AWS_CONTAINER_CREDENTIALS_RELATIVE_URI];\n    const full = options.awsContainerCredentialsFullUri ?? process.env[AWS_CONTAINER_CREDENTIALS_FULL_URI];\n    const token = options.awsContainerAuthorizationToken ?? process.env[AWS_CONTAINER_AUTHORIZATION_TOKEN];\n    const tokenFile = options.awsContainerAuthorizationTokenFile ?? process.env[AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE];\n    if (relative && full) {\n        console.warn(\"AWS SDK HTTP credentials provider:\", \"you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri.\");\n        console.warn(\"awsContainerCredentialsFullUri will take precedence.\");\n    }\n    if (token && tokenFile) {\n        console.warn(\"AWS SDK HTTP credentials provider:\", \"you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile.\");\n        console.warn(\"awsContainerAuthorizationToken will take precedence.\");\n    }\n    if (full) {\n        host = full;\n    }\n    else if (relative) {\n        host = `${DEFAULT_LINK_LOCAL_HOST}${relative}`;\n    }\n    else {\n        throw new CredentialsProviderError(`No HTTP credential provider host provided.\nSet AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.`);\n    }\n    const url = new URL(host);\n    checkUrl(url);\n    const requestHandler = new NodeHttpHandler({\n        requestTimeout: options.timeout ?? 1000,\n        connectionTimeout: options.timeout ?? 1000,\n    });\n    return retryWrapper(async () => {\n        const request = createGetRequest(url);\n        if (token) {\n            request.headers.Authorization = token;\n        }\n        else if (tokenFile) {\n            request.headers.Authorization = (await fs.readFile(tokenFile)).toString();\n        }\n        try {\n            const result = await requestHandler.handle(request);\n            return getCredentials(result.response);\n        }\n        catch (e) {\n            throw new CredentialsProviderError(String(e));\n        }\n    }, options.maxRetries ?? 3, options.timeout ?? 1000);\n};\n","import { CredentialsProviderError } from \"@smithy/property-provider\";\nconst LOOPBACK_CIDR_IPv4 = \"127.0.0.0/8\";\nconst LOOPBACK_CIDR_IPv6 = \"::1/128\";\nconst ECS_CONTAINER_HOST = \"169.254.170.2\";\nconst EKS_CONTAINER_HOST_IPv4 = \"169.254.170.23\";\nconst EKS_CONTAINER_HOST_IPv6 = \"[fd00:ec2::23]\";\nexport const checkUrl = (url) => {\n    if (url.protocol === \"https:\") {\n        return;\n    }\n    if (url.hostname === ECS_CONTAINER_HOST ||\n        url.hostname === EKS_CONTAINER_HOST_IPv4 ||\n        url.hostname === EKS_CONTAINER_HOST_IPv6) {\n        return;\n    }\n    if (url.hostname.includes(\"[\")) {\n        if (url.hostname === \"[::1]\" || url.hostname === \"[0000:0000:0000:0000:0000:0000:0000:0001]\") {\n            return;\n        }\n    }\n    else {\n        if (url.hostname === \"localhost\") {\n            return;\n        }\n        const ipComponents = url.hostname.split(\".\");\n        const inRange = (component) => {\n            const num = parseInt(component, 10);\n            return 0 <= num && num <= 255;\n        };\n        if (ipComponents[0] === \"127\" &&\n            inRange(ipComponents[1]) &&\n            inRange(ipComponents[2]) &&\n            inRange(ipComponents[3]) &&\n            ipComponents.length === 4) {\n            return;\n        }\n    }\n    throw new CredentialsProviderError(`URL not accepted. It must either be HTTPS or match one of the following:\n  - loopback CIDR 127.0.0.0/8 or [::1/128]\n  - ECS container host 169.254.170.2\n  - EKS container host 169.254.170.23 or [fd00:ec2::23]`);\n};\n","import { CredentialsProviderError } from \"@smithy/property-provider\";\nimport { HttpRequest } from \"@smithy/protocol-http\";\nimport { parseRfc3339DateTime } from \"@smithy/smithy-client\";\nimport { sdkStreamMixin } from \"@smithy/util-stream\";\nexport function createGetRequest(url) {\n    return new HttpRequest({\n        protocol: url.protocol,\n        hostname: url.hostname,\n        port: Number(url.port),\n        path: url.pathname,\n        query: Array.from(url.searchParams.entries()).reduce((acc, [k, v]) => {\n            acc[k] = v;\n            return acc;\n        }, {}),\n        fragment: url.hash,\n    });\n}\nexport async function getCredentials(response) {\n    const contentType = response?.headers[\"content-type\"] ?? response?.headers[\"Content-Type\"] ?? \"\";\n    if (!contentType.includes(\"json\")) {\n        console.warn(\"HTTP credential provider response header content-type was not application/json. Observed: \" + contentType + \".\");\n    }\n    const stream = sdkStreamMixin(response.body);\n    const str = await stream.transformToString();\n    if (response.statusCode === 200) {\n        const parsed = JSON.parse(str);\n        if (typeof parsed.AccessKeyId !== \"string\" ||\n            typeof parsed.SecretAccessKey !== \"string\" ||\n            typeof parsed.Token !== \"string\" ||\n            typeof parsed.Expiration !== \"string\") {\n            throw new CredentialsProviderError(\"HTTP credential provider response not of the required format, an object matching: \" +\n                \"{ AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }\");\n        }\n        return {\n            accessKeyId: parsed.AccessKeyId,\n            secretAccessKey: parsed.SecretAccessKey,\n            sessionToken: parsed.Token,\n            expiration: parseRfc3339DateTime(parsed.Expiration),\n        };\n    }\n    if (response.statusCode >= 400 && response.statusCode < 500) {\n        let parsedBody = {};\n        try {\n            parsedBody = JSON.parse(str);\n        }\n        catch (e) { }\n        throw Object.assign(new CredentialsProviderError(`Server responded with status: ${response.statusCode}`), {\n            Code: parsedBody.Code,\n            Message: parsedBody.Message,\n        });\n    }\n    throw new CredentialsProviderError(`Server responded with status: ${response.statusCode}`);\n}\n"],"names":["fromHttp","options","host","logger","debug","relative","awsContainerCredentialsRelativeUri","process","env","full","awsContainerCredentialsFullUri","token","awsContainerAuthorizationToken","tokenFile","awsContainerAuthorizationTokenFile","console","warn","url","URL","protocol","hostname","includes","ipComponents","split","inRange","component","num","parseInt","length","checkUrl","requestHandler","requestTimeout","timeout","connectionTimeout","toRetry","async","request","port","Number","path","pathname","query","Array","from","searchParams","entries","reduce","acc","k","v","fragment","hash","createGetRequest","headers","Authorization","toString","response","contentType","stream","body","str","transformToString","statusCode","parsed","JSON","parse","AccessKeyId","SecretAccessKey","Token","Expiration","accessKeyId","secretAccessKey","sessionToken","expiration","parsedBody","e","Object","assign","Code","Message","getCredentials","handle","String","maxRetries","delayMs","i","Promise","resolve","setTimeout"],"sourceRoot":""}